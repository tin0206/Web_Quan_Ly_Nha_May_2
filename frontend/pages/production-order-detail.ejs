<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chi tiết Production Order #<%= orderId %></title>
    <link rel="stylesheet" href="/css/main_style.css" />
    <link rel="stylesheet" href="/css/po_detail_style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <script type="module" src="/js/production_order_detail.js" defer></script>
  </head>
  <body>
    <div class="main-container">
      <div class="header-container">
        <a class="back-btn" href="/production-orders">
          <i class="fa-solid fa-arrow-left"></i>
        </a>
        <div class="header-text">
          <h1>Production Order Detail</h1>
          <p>
            ID:
            <strong><%= orderId %></strong>
          </p>
        </div>
      </div>
      <div>
        <div id="orderDetails" style="display: none">
          <div
            style="
              background: #fff;
              border-radius: 8px;
              padding: 30px;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              margin: 0 auto;
            "
          >
            <div
              style="
                display: grid;
                grid-template-columns: 1fr 1fr 1fr 1fr;
                gap: 20px;
                text-align: left;
              "
            >
              <div>
                <label style="font-weight: bold; color: #666">Mã Lệnh SX</label>
                <p
                  style="margin: 5px 0; font-size: 16px"
                  id="detailOrderNumber"
                >
                  -
                </p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666"
                  >Mã Sản Phẩm</label
                >
                <p
                  style="margin: 5px 0; font-size: 16px"
                  id="detailProductCode"
                >
                  -
                </p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666">Dây Chuyền</label>
                <p
                  style="margin: 5px 0; font-size: 16px"
                  id="detailProductionLine"
                >
                  -
                </p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666">Công Thức</label>
                <p style="margin: 5px 0; font-size: 16px" id="detailRecipeCode">
                  -
                </p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666"
                  >Phiên Bản Công Thức</label
                >
                <p
                  style="margin: 5px 0; font-size: 16px"
                  id="detailRecipeVersion"
                >
                  -
                </p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666">Lô SX</label>
                <p style="margin: 5px 0; font-size: 16px" id="detailLotNumber">
                  -
                </p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666">Số Lượng</label>
                <p style="margin: 5px 0; font-size: 16px" id="detailQuantity">
                  -
                </p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666"
                  >Batch hiện tại</label
                >
                <p
                  style="margin: 5px 0; font-size: 16px"
                  id="detailCurrentBatch"
                >
                  -
                </p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666"
                  >Ngày Bắt Đầu</label
                >
                <p
                  style="margin: 5px 0; font-size: 16px"
                  id="detailPlannedStart"
                >
                  -
                </p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666"
                  >Ngày Kết Thúc</label
                >
                <p style="margin: 5px 0; font-size: 16px" id="detailPlannedEnd">
                  -
                </p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666">Ca Làm</label>
                <p style="margin: 5px 0; font-size: 16px" id="detailShift">-</p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666">Tiến Độ</label>
                <p style="margin: 5px 0; font-size: 16px" id="detailProgress">
                  -
                </p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666">Trạng Thái</label>
                <p style="margin: 5px 0; font-size: 16px" id="detailStatus">
                  -
                </p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666">Plant</label>
                <p style="margin: 5px 0; font-size: 16px" id="detailPlant">-</p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666">Shop Floor</label>
                <p style="margin: 5px 0; font-size: 16px" id="detailShopfloor">
                  -
                </p>
              </div>
              <div>
                <label style="font-weight: bold; color: #666"
                  >Process Area</label
                >
                <p
                  style="margin: 5px 0; font-size: 16px"
                  id="detailProcessArea"
                >
                  -
                </p>
              </div>
            </div>
          </div>
        </div>
        <div
          id="tabsBar"
          style="
            margin-top: 20px;
            border-bottom: 2px solid #ddd;
            display: flex;
            gap: 10px;
          "
        >
          <button
            class="tab-button"
            id="tab-batches"
            style="
              padding: 10px 20px;
              border: none;
              background: none;
              cursor: pointer;
              font-size: 16px;
              border-bottom: 3px solid #007bff;
              color: #007bff;
              font-weight: bold;
            "
          >
            Production Batches
          </button>
          <button
            class="tab-button"
            id="tab-materials"
            style="
              padding: 10px 20px;
              border: none;
              background: none;
              cursor: pointer;
              font-size: 16px;
              border-bottom: 3px solid transparent;
              color: #666;
            "
          >
            Material Consumption
          </button>
        </div>
        <div id="batchesContent" style="margin-top: 20px">
          <table
            style="
              width: 100%;
              border-collapse: collapse;
              background: white;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            "
          >
            <thead>
              <tr
                style="background-color: #f5f5f5; border-bottom: 2px solid #ddd"
              >
                <th
                  style="
                    padding: 12px;
                    text-align: left;
                    font-weight: bold;
                    text-align: center;
                  "
                >
                  Batch ID
                </th>
                <th
                  style="
                    padding: 12px;
                    text-align: left;
                    font-weight: bold;
                    text-align: center;
                  "
                >
                  Batch Number
                </th>
                <th
                  style="
                    padding: 12px;
                    text-align: left;
                    font-weight: bold;
                    text-align: center;
                  "
                >
                  Plan Quantity
                </th>
                <th
                  style="
                    padding: 12px;
                    text-align: left;
                    font-weight: bold;
                    text-align: center;
                  "
                >
                  Status
                </th>
                <th
                  style="
                    padding: 12px;
                    text-align: left;
                    font-weight: bold;
                    text-align: center;
                  "
                >
                  View
                </th>
              </tr>
            </thead>
            <tbody id="batchesTableBody">
              <tr>
                <td
                  colspan="4"
                  style="padding: 20px; text-align: center; color: #999"
                >
                  Đang tải dữ liệu...
                </td>
              </tr>
            </tbody>
          </table>
          <div
            id="paginationControls"
            style="
              margin-top: 20px;
              display: flex;
              justify-content: center;
              align-items: center;
              gap: 15px;
              padding: 15px 0 20px 0;
            "
          >
            <button
              id="prevBtn"
              style="
                background: #007aff;
                color: white;
                border: none;
                border-radius: 6px;
                padding: 8px 12px;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                transition:
                  background 0.3s ease,
                  opacity 0.3s ease;
                font-size: 16px;
              "
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <polyline points="15 18 9 12 15 6"></polyline>
              </svg>
            </button>
            <span
              id="pageInfo"
              style="
                font-size: 14px;
                color: #666;
                font-weight: 500;
                min-width: 120px;
                text-align: center;
              "
            >
              Trang 0 / 1
            </span>
            <button
              id="nextBtn"
              style="
                background: #007aff;
                color: white;
                border: none;
                border-radius: 6px;
                padding: 8px 12px;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                transition:
                  background 0.3s ease,
                  opacity 0.3s ease;
                font-size: 16px;
              "
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <polyline points="9 18 15 12 9 6"></polyline>
              </svg>
            </button>
          </div>
        </div>
        <div id="materialsContent" style="display: none; margin-top: 20px">
          <!-- Batch Number Selection Section -->
          <div
            style="
              background: white;
              padding: 20px;
              border-radius: 8px;
              margin-bottom: 20px;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            "
          >
            <label
              style="
                font-weight: bold;
                color: #333;
                display: block;
                margin-bottom: 12px;
                font-size: 14px;
              "
              >Batch Number</label
            >
            <div
              id="filterBatchIdContainer"
              style="
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
                padding: 12px;
                border: 1px solid #ddd;
                border-radius: 4px;
                background: #fafafa;
                max-height: 200px;
                overflow-y: auto;
                overflow-x: hidden;
              "
            >
              <div
                id="filterBatchCodeOptions"
                style="display: flex; flex-wrap: wrap; gap: 10px; width: 100%"
              ></div>
            </div>
          </div>

          <!-- Material Type Filter -->
          <div style="margin-bottom: 20px">
            <label
              style="
                display: block;
                margin-bottom: 8px;
                font-weight: 500;
                color: #333;
                font-size: 14px;
              "
              >Loại vật liệu:</label
            >
            <div
              style="
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
                padding: 12px;
                border: 1px solid #ddd;
                border-radius: 4px;
                background: #fafafa;
              "
            >
              <div
                id="filterMaterialTypeOptions"
                style="display: flex; flex-wrap: wrap; gap: 10px; width: 100%"
              ></div>
            </div>
          </div>

          <!-- Filter Section -->
          <div
            style="
              background: white;
              padding: 20px;
              border-radius: 8px;
              margin-bottom: 20px;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            "
          >
            <div
              style="
                display: grid;
                grid-template-columns: 1fr 1fr 1fr auto;
                gap: 15px;
                align-items: flex-end;
              "
            >
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 8px;
                  "
                  >Ingredient Code</label
                >
                <input
                  type="text"
                  id="filterIngredientCode"
                  placeholder="Nhập mã nguyên liệu..."
                  style="
                    width: 100%;
                    padding: 8px 12px;
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    font-size: 14px;
                  "
                />
              </div>
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 8px;
                  "
                  >Lot</label
                >
                <input
                  type="text"
                  id="filterLot"
                  placeholder="Nhập lot..."
                  style="
                    width: 100%;
                    padding: 8px 12px;
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    font-size: 14px;
                  "
                />
              </div>
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 8px;
                  "
                  >Quantity</label
                >
                <input
                  id="filterQuantity"
                  placeholder="Nhập số lượng..."
                  style="
                    width: 100%;
                    padding: 8px 12px;
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    font-size: 14px;
                  "
                />
              </div>
              <button
                id="resetFilterBtn"
                style="
                  background: #6c757d;
                  color: white;
                  border: none;
                  padding: 8px 16px;
                  border-radius: 4px;
                  cursor: pointer;
                  font-size: 14px;
                  font-weight: bold;
                  transition: background 0.2s;
                "
              >
                Reset
              </button>
            </div>
          </div>
          <div
            id="materialsTableWrapper"
            style="
              width: 100%;
              background: white;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
              overflow-x: auto;
            "
          >
            <table
              style="
                width: 100%;
                border-collapse: collapse;
                background: white;
                box-shadow: none;
                min-width: 1360px;
              "
            >
              <thead>
                <tr
                  style="
                    background-color: #f5f5f5;
                    border-bottom: 2px solid #ddd;
                  "
                >
                  <th
                    style="
                      padding: 12px;
                      text-align: left;
                      font-weight: bold;
                      text-align: center;
                    "
                  >
                    ID
                  </th>
                  <th
                    style="
                      padding: 12px;
                      text-align: left;
                      font-weight: bold;
                      text-align: center;
                    "
                  >
                    Batch Number
                  </th>
                  <th
                    style="
                      padding: 12px;
                      text-align: left;
                      font-weight: bold;
                      text-align: center;
                    "
                  >
                    Ingredient Code
                  </th>
                  <th
                    style="
                      padding: 12px;
                      text-align: left;
                      font-weight: bold;
                      text-align: center;
                    "
                  >
                    Lot
                  </th>
                  <th
                    style="
                      padding: 12px;
                      text-align: left;
                      font-weight: bold;
                      text-align: center;
                    "
                  >
                    Plan Quantity
                  </th>
                  <th
                    style="
                      padding: 12px;
                      text-align: left;
                      font-weight: bold;
                      text-align: center;
                    "
                  >
                    Actual Quantity
                  </th>
                  <th
                    style="
                      padding: 12px;
                      text-align: left;
                      font-weight: bold;
                      text-align: center;
                    "
                  >
                    Consumption Date
                  </th>
                  <th
                    style="
                      padding: 12px;
                      text-align: left;
                      font-weight: bold;
                      text-align: center;
                    "
                  >
                    Status
                  </th>
                  <th
                    style="
                      padding: 12px;
                      text-align: left;
                      font-weight: bold;
                      text-align: center;
                    "
                  >
                    View
                  </th>
                </tr>
              </thead>
              <tbody id="materialsTableBody">
                <tr>
                  <td
                    colspan="9"
                    style="padding: 20px; text-align: center; color: #999"
                  >
                    Đang tải dữ liệu...
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <!-- Materials Pagination Controls -->
        <div
          id="materialsPaginationControls"
          style="
            margin-top: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            padding: 15px 0 20px 0;
          "
        >
          <button
            id="materialsPrevBtn"
            style="
              background: #007aff;
              color: white;
              border: none;
              border-radius: 6px;
              padding: 8px 12px;
              cursor: pointer;
              display: flex;
              align-items: center;
              justify-content: center;
              transition:
                background 0.3s ease,
                opacity 0.3s ease;
              font-size: 16px;
            "
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
          </button>
          <span
            id="materialsPageInfo"
            style="
              font-size: 14px;
              color: #666;
              font-weight: 500;
              min-width: 200px;
              text-align: center;
            "
          >
            Trang 0 / 1
          </span>
          <button
            id="materialsNextBtn"
            style="
              background: #007aff;
              color: white;
              border: none;
              border-radius: 6px;
              padding: 8px 12px;
              cursor: pointer;
              display: flex;
              align-items: center;
              justify-content: center;
              transition:
                background 0.3s ease,
                opacity 0.3s ease;
              font-size: 16px;
            "
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </button>
        </div>
        <!-- Ingredients Content -->
        <div id="ingredientsContent" style="display: none; margin-top: 20px">
          <!-- Batch Number Filter for Ingredients -->
          <div
            style="
              background: white;
              padding: 20px;
              border-radius: 8px;
              margin-bottom: 20px;
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            "
          >
            <label
              style="
                font-weight: bold;
                color: #666;
                display: block;
                margin-bottom: 12px;
              "
              >Batch Number</label
            >
            <div
              id="filterIngredientsBatchCodeContainer"
              style="
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
                padding: 12px;
                border: 1px solid #ddd;
                border-radius: 4px;
                background: #fafafa;
                max-height: 200px;
                overflow-y: auto;
                overflow-x: hidden;
              "
            >
              <div
                id="filterIngredientsBatchCodeOptions"
                style="display: flex; flex-wrap: wrap; gap: 10px; width: 100%"
              ></div>
            </div>
          </div>

          <!-- Ingredients Summary -->
          <div id="ingredientsSummary"></div>

          <table
            style="
              width: 100%;
              border-collapse: collapse;
              background: white;
              margin-bottom: 20px;
            "
          >
            <thead>
              <tr style="background: #f5f5f5; border-bottom: 2px solid #ddd">
                <th
                  style="
                    padding: 12px;
                    text-align: center;
                    font-weight: 600;
                    color: #333;
                  "
                >
                  ID
                </th>
                <th
                  style="
                    padding: 12px;
                    text-align: center;
                    font-weight: 600;
                    color: #333;
                  "
                >
                  Batch Number
                </th>
                <th
                  style="
                    padding: 12px;
                    text-align: center;
                    font-weight: 600;
                    color: #333;
                  "
                >
                  Ingredient Code
                </th>
                <th
                  style="
                    padding: 12px;
                    text-align: center;
                    font-weight: 600;
                    color: #333;
                  "
                >
                  Plan_Quantity
                </th>
                <th
                  style="
                    padding: 12px;
                    text-align: center;
                    font-weight: 600;
                    color: #333;
                  "
                >
                  Actual_Quantity
                </th>
              </tr>
            </thead>
            <tbody id="ingredientsTableBody">
              <tr>
                <td
                  colspan="5"
                  style="padding: 20px; text-align: center; color: #999"
                >
                  Không có dữ liệu
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <!-- Ingredients Pagination Controls -->
        <div
          id="ingredientsPaginationControls"
          style="
            margin-top: 20px;
            display: none;
            justify-content: center;
            align-items: center;
            gap: 15px;
            padding: 15px 0 20px 0;
          "
        >
          <button
            id="ingredientsPrevBtn"
            style="
              background: #007aff;
              color: white;
              border: none;
              border-radius: 6px;
              padding: 8px 12px;
              cursor: pointer;
              display: flex;
              align-items: center;
              justify-content: center;
              transition:
                background 0.3s ease,
                opacity 0.3s ease;
              font-size: 16px;
            "
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
          </button>
          <span
            id="ingredientsPageInfo"
            style="
              font-size: 14px;
              color: #666;
              font-weight: 500;
              min-width: 200px;
              text-align: center;
            "
          >
            Trang 0 / 1
          </span>
          <button
            id="ingredientsNextBtn"
            style="
              background: #007aff;
              color: white;
              border: none;
              border-radius: 6px;
              padding: 8px 12px;
              cursor: pointer;
              display: flex;
              align-items: center;
              justify-content: center;
              transition:
                background 0.3s ease,
                opacity 0.3s ease;
              font-size: 16px;
            "
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </button>
        </div>

        <!-- Material Detail Modal -->
        <div
          id="materialModal"
          style="
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
          "
        >
          <div
            style="
              background: white;
              border-radius: 8px;
              padding: 30px;
              max-width: 600px;
              width: 90%;
              max-height: 80vh;
              overflow-y: auto;
              box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            "
          >
            <div
              style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 20px;
                border-bottom: 2px solid #ddd;
                padding-bottom: 15px;
              "
            >
              <h2 style="margin: 0; color: #333">Chi Tiết Vật Liệu Tiêu Thụ</h2>
              <button
                id="closeModalBtn"
                style="
                  background: none;
                  border: none;
                  font-size: 24px;
                  cursor: pointer;
                  color: #666;
                "
              >
                &times;
              </button>
            </div>
            <div
              id="modalContent"
              style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px"
            >
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >ID</label
                >
                <p
                  id="modalId"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                  "
                >
                  -
                </p>
              </div>
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Production Order Number</label
                >
                <p
                  id="modalProductionOrderNumber"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                  "
                >
                  -
                </p>
              </div>
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Batch Code</label
                >
                <p
                  id="modalBatchCode"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                  "
                >
                  -
                </p>
              </div>
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Ingredient Code</label
                >
                <p
                  id="modalIngredientCode"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                  "
                >
                  -
                </p>
              </div>
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Lot</label
                >
                <p
                  id="modalLot"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                  "
                >
                  -
                </p>
              </div>
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Plan Quantity</label
                >
                <p
                  id="modalPlanQuantity"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                  "
                >
                  -
                </p>
              </div>
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Actual Quantity</label
                >
                <p
                  id="modalQuantity"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                  "
                >
                  -
                </p>
              </div>
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Consumption Date</label
                >
                <p
                  id="modalDateTime"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                  "
                >
                  -
                </p>
              </div>
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Status</label
                >
                <p
                  id="modalStatusDisplay"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                  "
                >
                  -
                </p>
              </div>
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Count</label
                >
                <p
                  id="modalCount"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                  "
                >
                  -
                </p>
              </div>
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Operator ID</label
                >
                <p
                  id="modalOperatorId"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                  "
                >
                  -
                </p>
              </div>
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Supply Machine</label
                >
                <p
                  id="modalSupplyMachine"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                  "
                >
                  -
                </p>
              </div>
              <div>
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Timestamp</label
                >
                <p
                  id="modalTimestamp"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                  "
                >
                  -
                </p>
              </div>
              <div style="grid-column: 1 / -1">
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Request</label
                >
                <pre
                  id="modalRequest"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                    overflow-x: auto;
                    font-size: 16px;
                    max-height: 500px;
                  "
                >
                -</pre
                >
              </div>
              <div style="grid-column: 1 / -1">
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Response</label
                >
                <pre
                  id="modalResponse"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                    overflow-x: auto;
                    font-size: 16px;
                    max-height: 150px;
                  "
                >
                -</pre
                >
              </div>
              <div style="grid-column: 1 / -1">
                <label
                  style="
                    font-weight: bold;
                    color: #666;
                    display: block;
                    margin-bottom: 5px;
                  "
                  >Status</label
                >
                <pre
                  id="modalStatus"
                  style="
                    margin: 0;
                    padding: 8px;
                    background: #f5f5f5;
                    border-radius: 4px;
                    overflow-x: auto;
                    max-height: 200px;
                    font-size: 16px;
                  "
                >
                -</pre
                >
              </div>
            </div>
          </div>
        </div>

        <!-- Material List Modal (for grouped materials) -->
        <div
          id="materialListModal"
          style="
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 9998;
            justify-content: center;
            align-items: center;
          "
        >
          <div
            style="
              background: white;
              border-radius: 12px;
              width: 90%;
              max-width: 1200px;
              max-height: 90vh;
              overflow-y: auto;
              box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            "
          >
            <div
              style="
                padding: 20px 30px;
                border-bottom: 2px solid #f0f0f0;
                display: flex;
                justify-content: space-between;
                align-items: center;
                position: sticky;
                top: 0;
                background: white;
                z-index: 1;
              "
            >
              <div id="listModalTitle" style="flex: 1"></div>
              <button
                onclick="closeMaterialListModal()"
                style="
                  background: #e74c3c;
                  color: white;
                  border: none;
                  border-radius: 6px;
                  padding: 8px 16px;
                  cursor: pointer;
                  font-weight: bold;
                  transition: background 0.3s ease;
                "
                onmouseover="this.style.background = '#c0392b'"
                onmouseout="this.style.background = '#e74c3c'"
              >
                Đóng
              </button>
            </div>
            <div style="padding: 30px">
              <table
                style="
                  width: 100%;
                  border-collapse: collapse;
                  background: white;
                "
              >
                <thead>
                  <tr
                    style="background: #f5f5f5; border-bottom: 2px solid #ddd"
                  >
                    <th
                      style="
                        padding: 12px;
                        text-align: center;
                        font-weight: 600;
                        color: #333;
                      "
                    >
                      ID
                    </th>
                    <th
                      style="
                        padding: 12px;
                        text-align: center;
                        font-weight: 600;
                        color: #333;
                      "
                    >
                      Batch Number
                    </th>
                    <th
                      style="
                        padding: 12px;
                        text-align: center;
                        font-weight: 600;
                        color: #333;
                      "
                    >
                      Ingredient Code
                    </th>
                    <th
                      style="
                        padding: 12px;
                        text-align: center;
                        font-weight: 600;
                        color: #333;
                      "
                    >
                      Lot
                    </th>
                    <th
                      style="
                        padding: 12px;
                        text-align: center;
                        font-weight: 600;
                        color: #333;
                      "
                    >
                      Plan Quantity
                    </th>
                    <th
                      style="
                        padding: 12px;
                        text-align: center;
                        font-weight: 600;
                        color: #333;
                      "
                    >
                      Actual Quantity
                    </th>
                    <th
                      style="
                        padding: 12px;
                        text-align: center;
                        font-weight: 600;
                        color: #333;
                      "
                    >
                      Consumption Date
                    </th>
                    <th
                      style="
                        padding: 12px;
                        text-align: center;
                        font-weight: 600;
                        color: #333;
                      "
                    >
                      Status
                    </th>
                    <th
                      style="
                        padding: 12px;
                        text-align: center;
                        font-weight: 600;
                        color: #333;
                      "
                    >
                      Actions
                    </th>
                  </tr>
                </thead>
                <tbody id="materialListTableBody">
                  <!-- Rows will be rendered by JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <div id="loadingMessage">
          <p>Đang tải dữ liệu...</p>
        </div>
      </div>
    </div>
  </body>
</html>
